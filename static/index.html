<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morey C1-Core Device Manager</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #101820; /* Morey SHADE */
            color: #CFDBE2; /* Morey FROST */
            min-height: 100vh;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #101820 0%, #1a252f 100%);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 2px solid #E1FF16; /* Morey DAYLIGHT */
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #E1FF16, #FF4F39, #E1FF16);
        }

        .morey-logo {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .logomark {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .morey-logo-svg {
            width: 60px;
            height: 60px;
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: -0.02em;
            color: #E1FF16; /* Morey DAYLIGHT */
            margin-bottom: 10px;
        }

        .header p {
            color: #BBAE9E; /* Morey SAND */
            font-size: 1.2rem;
            font-weight: 500;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: linear-gradient(145deg, #1a252f 0%, #101820 100%);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid #BBAE9E; /* Morey SAND */
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #E1FF16, #FF4F39);
        }

        .card:hover {
            transform: translateY(-5px);
            border-color: #E1FF16;
            box-shadow: 0 20px 40px rgba(225, 255, 22, 0.1);
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #E1FF16; /* Morey DAYLIGHT */
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            animation: pulse 2s infinite;
        }

        .status-active { background: #E1FF16; } /* Morey DAYLIGHT */
        .status-low-power { background: #FF4F39; } /* Morey HEAT */
        .status-error { background: #FF4F39; }
        .status-offline { background: #BBAE9E; } /* Morey SAND */

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 18px;
            padding: 15px;
            background: rgba(225, 255, 22, 0.05);
            border-radius: 12px;
            border-left: 3px solid #E1FF16;
            transition: all 0.3s ease;
        }

        .metric-row:hover {
            background: rgba(225, 255, 22, 0.1);
            transform: translateX(5px);
        }

        .metric-label {
            font-weight: 600;
            color: #CFDBE2; /* Morey FROST */
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 0.02em;
        }

        .metric-value {
            font-weight: 700;
            font-size: 1.2rem;
            color: #E1FF16; /* Morey DAYLIGHT */
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(16, 24, 32, 0.8);
            border-radius: 6px;
            overflow: hidden;
            margin-top: 10px;
            border: 1px solid #BBAE9E;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #E1FF16, #E1FF16);
            border-radius: 5px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-warning { background: linear-gradient(90deg, #FF4F39, #FF4F39); }
        .progress-danger { background: linear-gradient(90deg, #FF4F39, #FF4F39); }

        .interface-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
        }

        .interface-item {
            background: rgba(225, 255, 22, 0.05);
            padding: 18px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .interface-item.connected {
            border-color: #E1FF16;
            background: rgba(225, 255, 22, 0.1);
            box-shadow: 0 0 20px rgba(225, 255, 22, 0.2);
        }

        .interface-item.disconnected {
            border-color: #FF4F39;
            background: rgba(255, 79, 57, 0.1);
        }

        .interface-name {
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 8px;
            color: #E1FF16;
            letter-spacing: 0.05em;
        }

        .interface-status {
            font-size: 0.85rem;
            color: #CFDBE2;
            font-weight: 500;
        }

        .controls-panel {
            background: linear-gradient(145deg, #1a252f 0%, #101820 100%);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid #BBAE9E;
            margin-top: 30px;
        }

        .controls-title {
            font-size: 1.6rem;
            font-weight: 700;
            text-transform: uppercase;
            color: #E1FF16;
            margin-bottom: 25px;
            letter-spacing: 0.05em;
        }

        .control-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: #E1FF16;
            color: #101820;
            border: 2px solid #E1FF16;
        }

        .btn-primary:hover {
            background: transparent;
            color: #E1FF16;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(225, 255, 22, 0.3);
        }

        .btn-success {
            background: transparent;
            color: #E1FF16;
            border: 2px solid #E1FF16;
        }

        .btn-success:hover {
            background: #E1FF16;
            color: #101820;
            transform: translateY(-3px);
        }

        .btn-warning {
            background: transparent;
            color: #FF4F39;
            border: 2px solid #FF4F39;
        }

        .btn-warning:hover {
            background: #FF4F39;
            color: #101820;
            transform: translateY(-3px);
        }

        .btn-danger {
            background: #FF4F39;
            color: #101820;
            border: 2px solid #FF4F39;
        }

        .btn-danger:hover {
            background: transparent;
            color: #FF4F39;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 79, 57, 0.3);
        }

        .log-panel {
            background: rgba(16, 24, 32, 0.8);
            border-radius: 15px;
            padding: 25px;
            max-height: 350px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            border: 1px solid #BBAE9E;
        }

        .log-entry {
            margin-bottom: 10px;
            padding: 10px 15px;
            border-radius: 8px;
            border-left: 4px solid #E1FF16;
            background: rgba(225, 255, 22, 0.05);
            transition: all 0.3s ease;
        }

        .log-entry:hover {
            background: rgba(225, 255, 22, 0.1);
            transform: translateX(5px);
        }

        .log-warning { 
            border-left-color: #FF4F39; 
            background: rgba(255, 79, 57, 0.05);
        }
        .log-error { 
            border-left-color: #FF4F39; 
            background: rgba(255, 79, 57, 0.1);
        }
        .log-success { 
            border-left-color: #E1FF16; 
            background: rgba(225, 255, 22, 0.1);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(16, 24, 32, 0.9);
            backdrop-filter: blur(10px);
        }

        .modal-content {
            background: linear-gradient(145deg, #1a252f 0%, #101820 100%);
            margin: 5% auto;
            padding: 40px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            border: 2px solid #E1FF16;
            position: relative;
            animation: modalSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes modalSlideIn {
            from { 
                transform: translateY(-50px) scale(0.9); 
                opacity: 0; 
            }
            to { 
                transform: translateY(0) scale(1); 
                opacity: 1; 
            }
        }

        .close {
            color: #BBAE9E;
            float: right;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s ease;
            line-height: 1;
        }

        .close:hover {
            color: #E1FF16;
            transform: scale(1.1);
        }

        .modal h2 {
            color: #E1FF16;
            font-size: 1.8rem;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 25px;
            letter-spacing: 0.05em;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #E1FF16;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 0.05em;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #BBAE9E;
            border-radius: 10px;
            background: rgba(16, 24, 32, 0.8);
            color: #CFDBE2;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #E1FF16;
            box-shadow: 0 0 15px rgba(225, 255, 22, 0.2);
        }

        .form-group input::placeholder, .form-group textarea::placeholder {
            color: #BBAE9E;
        }

        .timestamp {
            position: absolute;
            top: 25px;
            right: 25px;
            font-size: 1rem;
            color: #BBAE9E;
            font-weight: 500;
            background: rgba(225, 255, 22, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #E1FF16;
        }

        .diagnostic-result {
            margin-top: 25px;
            padding: 20px;
            background: rgba(225, 255, 22, 0.05);
            border-radius: 10px;
            border: 1px solid #E1FF16;
        }

        /* Custom scrollbar */
        .log-panel::-webkit-scrollbar {
            width: 8px;
        }

        .log-panel::-webkit-scrollbar-track {
            background: rgba(16, 24, 32, 0.5);
            border-radius: 4px;
        }

        .log-panel::-webkit-scrollbar-thumb {
            background: #E1FF16;
            border-radius: 4px;
        }

        .log-panel::-webkit-scrollbar-thumb:hover {
            background: #FF4F39;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .control-buttons {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .timestamp {
                position: static;
                margin-bottom: 20px;
                display: inline-block;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="timestamp" id="currentTime"></div>
        
        <div class="header">
            <div class="morey-logo">
                <div class="logomark">
                    <!-- Morey Logomark SVG -->
                    <svg class="morey-logo-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <!-- Circular background in Morey DAYLIGHT -->
                        <circle cx="50" cy="50" r="50" fill="#E1FF16"/>
                        <!-- Morey 'M' logomark in SHADE color -->
                        <path d="M25 30 C25 30, 25 25, 30 25 C35 25, 40 30, 45 35 C50 40, 50 40, 50 40 C50 40, 50 40, 55 35 C60 30, 65 25, 70 25 C75 25, 75 30, 75 30 L75 70 C75 70, 75 75, 70 75 C65 75, 65 70, 65 70 L65 45 C65 45, 60 50, 55 55 C50 60, 50 60, 50 60 C50 60, 50 60, 45 55 C40 50, 35 45, 35 45 L35 70 C35 70, 35 75, 30 75 C25 75, 25 70, 25 70 Z" fill="#101820"/>
                    </svg>
                </div>
                <div>
                    <h1>C1-Core Device Manager</h1>
                    <p>Advanced Telematics Platform for Light & Heavy Duty Vehicles</p>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- System Status Card -->
            <div class="card">
                <h3 class="card-title">
                    <span class="status-indicator status-active" id="systemStatusIndicator"></span>
                    System Status
                </h3>
                <div class="metric-row">
                    <span class="metric-label">Current State:</span>
                    <span class="metric-value" id="currentState">ACTIVE</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Uptime:</span>
                    <span class="metric-value" id="uptime">2h 34m 12s</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Last Reset:</span>
                    <span class="metric-value" id="lastReset">Power On Reset</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Power Draw:</span>
                    <span class="metric-value" id="powerConsumption">1.2A</span>
                </div>
            </div>

            <!-- System Health Card -->
            <div class="card">
                <h3 class="card-title">System Health</h3>
                <div class="metric-row">
                    <span class="metric-label">CPU Usage:</span>
                    <span class="metric-value" id="cpuUsage">45%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="cpuProgress" style="width: 45%"></div>
                </div>
                
                <div class="metric-row">
                    <span class="metric-label">Memory Usage:</span>
                    <span class="metric-value" id="memoryUsage">62%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="memoryProgress" style="width: 62%"></div>
                </div>
                
                <div class="metric-row">
                    <span class="metric-label">CPU Temperature:</span>
                    <span class="metric-value" id="cpuTemp">52¬∞C</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="tempProgress" style="width: 74%"></div>
                </div>
            </div>

            <!-- Power Management Card -->
            <div class="card">
                <h3 class="card-title">Power Management</h3>
                <div class="metric-row">
                    <span class="metric-label">External Voltage:</span>
                    <span class="metric-value" id="externalVoltage">12.8V</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="extVoltageProgress" style="width: 85%"></div>
                </div>
                
                <div class="metric-row">
                    <span class="metric-label">Internal Battery:</span>
                    <span class="metric-value" id="internalBattery">87%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="batteryProgress" style="width: 87%"></div>
                </div>
                
                <div class="metric-row">
                    <span class="metric-label">Charger Status:</span>
                    <span class="metric-value" id="chargerStatus">Charging</span>
                </div>
            </div>

            <!-- Interface Status Card -->
            <div class="card">
                <h3 class="card-title">Interface Status</h3>
                <div class="interface-grid" id="interfaceGrid">
                    <!-- Interfaces will be dynamically populated -->
                </div>
            </div>

            <!-- Docker Containers Card -->
            <div class="card">
                <h3 class="card-title">Docker Containers</h3>
                <div id="containerList">
                    <!-- Containers will be dynamically populated -->
                </div>
            </div>

            <!-- Location & GNSS Card -->
            <div class="card">
                <h3 class="card-title">Location & GNSS</h3>
                <div class="metric-row">
                    <span class="metric-label">GPS Status:</span>
                    <span class="metric-value" id="gpsStatus">Fix Acquired</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Satellites:</span>
                    <span class="metric-value" id="satellites">8/12</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Accuracy:</span>
                    <span class="metric-value" id="gpsAccuracy">2.3m</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Last Update:</span>
                    <span class="metric-value" id="lastGpsUpdate">2s ago</span>
                </div>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="controls-panel">
            <h3 class="controls-title">System Controls</h3>
            <div class="control-buttons">
                <button class="btn btn-primary" onclick="runDiagnostics()">Run Diagnostics</button>
                <button class="btn btn-success" onclick="runPOST()">Run POST</button>
                <button class="btn btn-warning" onclick="enterLowPower()">Low Power Mode</button>
                <button class="btn btn-primary" onclick="updateConfig()">Update Config</button>
                <button class="btn btn-success" onclick="restartServices()">Restart Services</button>
                <button class="btn btn-danger" onclick="emergencyShutdown()">Emergency Shutdown</button>
            </div>

            <!-- System Logs -->
            <h4 style="margin-bottom: 15px; color: #E1FF16; font-weight: 700; text-transform: uppercase;">System Logs</h4>
            <div class="log-panel" id="logPanel">
                <!-- Logs will be populated here -->
            </div>
        </div>
    </div>

    <!-- Configuration Modal -->
    <div id="configModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Update Configuration</h2>
            <form id="configForm">
                <div class="form-group">
                    <label for="configName">Configuration Name:</label>
                    <input type="text" id="configName" placeholder="e.g., cellular_settings">
                </div>
                <div class="form-group">
                    <label for="configData">Configuration Data (JSON):</label>
                    <textarea id="configData" rows="8" placeholder='{"apn": "internet.provider.com", "timeout": 30}'></textarea>
                </div>
                <button type="button" class="btn btn-success" onclick="submitConfig()">Apply Configuration</button>
            </form>
        </div>
    </div>

    <!-- Diagnostics Modal -->
    <div id="diagnosticsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Run Diagnostics</h2>
            <div class="form-group">
                <label for="diagnosticLevel">Diagnostic Level:</label>
                <select id="diagnosticLevel">
                    <option value="basic">Basic</option>
                    <option value="medium">Medium</option>
                    <option value="advanced">Advanced</option>
                </select>
            </div>
            <button type="button" class="btn btn-primary" onclick="submitDiagnostics()">Run Diagnostics</button>
            <div id="diagnosticsResult" class="diagnostic-result" style="display: none;"></div>
        </div>
    </div>

    <script>
        // Simulated device manager connection
        class DeviceManagerUI {
            constructor() {
                this.connected = false;
                this.systemData = {};
                this.logEntries = [];
                this.startTime = Date.now();
                this.init();
            }

            init() {
                this.updateTimestamp();
                this.simulateConnection();
                this.startDataUpdates();
                this.populateInterfaces();
                this.populateContainers();
                this.addInitialLogs();
                
                setInterval(() => this.updateTimestamp(), 1000);
                setInterval(() => this.updateSystemData(), 3000);
                setInterval(() => this.updateUptime(), 1000);
            }

            updateTimestamp() {
                const now = new Date();
                document.getElementById('currentTime').textContent = 
                    now.toLocaleDateString() + ' ' + now.toLocaleTimeString();
            }

            updateUptime() {
                const uptime = Date.now() - this.startTime;
                const hours = Math.floor(uptime / (1000 * 60 * 60));
                const minutes = Math.floor((uptime % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((uptime % (1000 * 60)) / 1000);
                
                document.getElementById('uptime').textContent = 
                    `${hours}h ${minutes}m ${seconds}s`;
            }

            simulateConnection() {
                this.connected = true;
                this.addLog('success', 'Connected to C1-Core Device Manager');
                this.addLog('info', 'System initialization complete');
            }

            updateSystemData() {
                // Simulate realistic telematics data changes
                const cpuUsage = Math.floor(Math.random() * 25) + 25; // 25-50%
                const memoryUsage = Math.floor(Math.random() * 15) + 55; // 55-70%
                const cpuTemp = Math.floor(Math.random() * 15) + 45; // 45-60¬∞C
                const extVoltage = (Math.random() * 1.5 + 11.8).toFixed(1); // 11.8-13.3V
                const battery = Math.floor(Math.random() * 15) + 80; // 80-95%

                // Update UI elements with smooth transitions
                this.updateElement('cpuUsage', cpuUsage + '%');
                this.updateProgressBar('cpuProgress', cpuUsage);
                
                this.updateElement('memoryUsage', memoryUsage + '%');
                this.updateProgressBar('memoryProgress', memoryUsage);
                
                this.updateElement('cpuTemp', cpuTemp + '¬∞C');
                this.updateProgressBar('tempProgress', (cpuTemp * 100 / 85));
                
                this.updateElement('externalVoltage', extVoltage + 'V');
                this.updateProgressBar('extVoltageProgress', (extVoltage * 100 / 15));
                
                this.updateElement('internalBattery', battery + '%');
                this.updateProgressBar('batteryProgress', battery);

                // Update power consumption based on state
                const state = document.getElementById('currentState').textContent;
                let powerConsumption, statusClass;
                switch(state) {
                    case 'ACTIVE': 
                        powerConsumption = '1.2A'; 
                        statusClass = 'status-active';
                        break;
                    case 'LOW_POWER': 
                        powerConsumption = '500ŒºA'; 
                        statusClass = 'status-low-power';
                        break;
                    case 'INTERNAL_BATTERY_ONLY': 
                        powerConsumption = '250ŒºA'; 
                        statusClass = 'status-low-power';
                        break;
                    case 'STORAGE_MODE': 
                        powerConsumption = '100ŒºA'; 
                        statusClass = 'status-offline';
                        break;
                    default: 
                        powerConsumption = '1.2A';
                        statusClass = 'status-active';
                }
                this.updateElement('powerConsumption', powerConsumption);
                document.getElementById('systemStatusIndicator').className = `status-indicator ${statusClass}`;

                // Update GPS data
                const satellites = Math.floor(Math.random() * 4) + 8; // 8-12 satellites
                const accuracy = (Math.random() * 2 + 1).toFixed(1); // 1.0-3.0m
                this.updateElement('satellites', satellites + '/12');
                this.updateElement('gpsAccuracy', accuracy + 'm');

                // Update progress bar colors based on values
                this.updateProgressBarColors(cpuUsage, memoryUsage, cpuTemp);
            }

            updateElement(id, value) {
                const element = document.getElementById(id);
                if (element && element.textContent !== value) {
                    element.style.transform = 'scale(1.05)';
                    element.textContent = value;
                    setTimeout(() => {
                        element.style.transform = 'scale(1)';
                    }, 150);
                }
            }

            updateProgressBar(id, percentage) {
                const element = document.getElementById(id);
                if (element) {
                    element.style.width = percentage + '%';
                }
            }

            updateProgressBarColors(cpu, memory, temp) {
                const cpuBar = document.getElementById('cpuProgress');
                const memoryBar = document.getElementById('memoryProgress');
                const tempBar = document.getElementById('tempProgress');

                // CPU colors
                cpuBar.className = 'progress-fill';
                if (cpu > 80) cpuBar.classList.add('progress-danger');
                else if (cpu > 60) cpuBar.classList.add('progress-warning');

                // Memory colors
                memoryBar.className = 'progress-fill';
                if (memory > 85) memoryBar.classList.add('progress-danger');
                else if (memory > 70) memoryBar.classList.add('progress-warning');

                // Temperature colors
                tempBar.className = 'progress-fill';
                if (temp > 70) tempBar.classList.add('progress-danger');
                else if (temp > 60) tempBar.classList.add('progress-warning');
            }

            populateInterfaces() {
                const interfaces = [
                    { name: 'Cellular', connected: true },
                    { name: 'GPS', connected: true },
                    { name: 'WiFi', connected: false },
                    { name: 'Bluetooth', connected: true },
                    { name: 'CAN1', connected: true },
                    { name: 'CAN2', connected: true },
                    { name: 'Ethernet', connected: false },
                    { name: 'RS485', connected: true }
                ];

                const container = document.getElementById('interfaceGrid');
                container.innerHTML = '';

                interfaces.forEach(iface => {
                    const div = document.createElement('div');
                    div.className = `interface-item ${iface.connected ? 'connected' : 'disconnected'}`;
                    div.innerHTML = `
                        <div class="interface-name">${iface.name}</div>
                        <div class="interface-status">${iface.connected ? 'Connected' : 'Disconnected'}</div>
                    `;
                    container.appendChild(div);
                });
            }

            populateContainers() {
                const containers = [
                    { name: 'morey-essential', status: 'running', essential: true },
                    { name: 'gnss-location', status: 'running', essential: true },
                    { name: 'cellular-comm', status: 'running', essential: true },
                    { name: 'ble-monitor', status: 'running', essential: true },
                    { name: 'can-interface', status: 'running', essential: true },
                    { name: 'user-app-1', status: 'stopped', essential: false }
                ];

                const container = document.getElementById('containerList');
                container.innerHTML = '';

                containers.forEach(cont => {
                    const div = document.createElement('div');
                    div.className = 'metric-row';
                    div.innerHTML = `
                        <span class="metric-label">
                            ${cont.name} ${cont.essential ? '‚≠ê' : ''}
                        </span>
                        <span class="metric-value" style="color: ${cont.status === 'running' ? '#E1FF16' : '#FF4F39'}">
                            ${cont.status.toUpperCase()}
                        </span>
                    `;
                    container.appendChild(div);
                });
            }

            addLog(level, message) {
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = { timestamp, level, message };
                this.logEntries.unshift(logEntry);
                
                // Keep only last 50 entries
                if (this.logEntries.length > 50) {
                    this.logEntries = this.logEntries.slice(0, 50);
                }
                
                this.updateLogDisplay();
            }

            updateLogDisplay() {
                const container = document.getElementById('logPanel');
                container.innerHTML = '';
                
                this.logEntries.forEach(entry => {
                    const div = document.createElement('div');
                    div.className = `log-entry log-${entry.level}`;
                    div.innerHTML = `<strong>[${entry.timestamp}]</strong> ${entry.message}`;
                    container.appendChild(div);
                });
                
                // Auto-scroll to top for new entries
                container.scrollTop = 0;
            }

            addInitialLogs() {
                this.addLog('success', 'C1-Core Device Manager v1.0.0 started successfully');
                this.addLog('info', 'POST completed in 8.2s - all 25 tests passed');
                this.addLog('info', 'Docker containers: 5 essential services running');
                this.addLog('info', 'Morey Essential App v2.1.4 loaded');
                this.addLog('info', 'CAN-FD interfaces initialized on buses 1 & 2');
                this.addLog('info', 'GNSS constellation lock: GPS(8) + GLONASS(4) satellites');
                this.addLog('info', 'LTE Cat-1 modem connected to carrier network');
                this.addLog('warning', 'WiFi interface disabled - no configured networks');
                this.addLog('info', 'Bluetooth 5.2 in observer mode - monitoring 12 beacons');
                this.addLog('info', 'System state: ACTIVE - external power 12.8V nominal');
                this.addLog('info', 'Internal battery: 87% charged, charger active');
            }

            startDataUpdates() {
                // Simulate realistic telematics log updates
                const telematicsMessages = [
                    'CAN frame received: Engine RPM 1850, Speed 65 mph',
                    'GPS location updated: 41.8781¬∞N, 87.6298¬∞W (¬±2.1m)',
                    'Cellular signal: -72 dBm, SNR 18.5 dB',
                    'Battery management: Charging at 1.2A, temp 32¬∞C',
                    'J1939 DTC cleared: Engine coolant temperature sensor',
                    'BLE beacon detected: Asset tag #A7291 RSSI -45dBm',
                    'Geofence event: Entered "Chicago Distribution Center"',
                    'Vehicle diagnostic: Oil pressure 45 PSI, coolant 185¬∞F',
                    'OTA configuration received: Cellular APN updated',
                    'Motion detection: Vehicle accelerating 0.3g forward',
                    'CAN-FD message: Transmission gear position P->D',
                    'Wake signal received: Ignition ON detected'
                ];
                
                setInterval(() => {
                    if (Math.random() < 0.4) { // 40% chance every 5 seconds
                        const message = telematicsMessages[Math.floor(Math.random() * telematicsMessages.length)];
                        this.addLog('info', message);
                    }
                }, 5000);

                // Simulate occasional warnings/errors
                setInterval(() => {
                    if (Math.random() < 0.1) { // 10% chance every 10 seconds
                        const warningMessages = [
                            'CPU temperature elevated: 68¬∞C (threshold 70¬∞C)',
                            'Memory usage high: 82% (threshold 85%)',
                            'External voltage low: 11.2V (threshold 11.0V)',
                            'GPS accuracy degraded: 4.2m (target <3.0m)',
                            'Container restart: user-app-1 restarted (exit code 1)'
                        ];
                        const message = warningMessages[Math.floor(Math.random() * warningMessages.length)];
                        this.addLog('warning', message);
                    }
                }, 10000);
            }
        }

        // Global functions for UI interactions
        function runDiagnostics() {
            document.getElementById('diagnosticsModal').style.display = 'block';
        }

        function runPOST() {
            deviceUI.addLog('info', 'Initiating Power-On Self Test sequence...');
            deviceUI.addLog('info', 'Testing external voltage: 12.8V - PASS');
            setTimeout(() => {
                deviceUI.addLog('info', 'Testing internal battery: 87% charged - PASS');
                deviceUI.addLog('info', 'Testing OS integrity: All critical files verified - PASS');
            }, 1000);
            setTimeout(() => {
                deviceUI.addLog('info', 'Testing RAM: 1024MB accessible - PASS');
                deviceUI.addLog('info', 'Testing FLASH: 8GB storage verified - PASS');
            }, 2000);
            setTimeout(() => {
                deviceUI.addLog('info', 'Testing CAN interfaces: Both buses responsive - PASS');
                deviceUI.addLog('info', 'Testing wireless modules: WiFi/BT operational - PASS');
            }, 3000);
            setTimeout(() => {
                deviceUI.addLog('success', 'POST completed successfully in 9.7s - ALL SYSTEMS OPERATIONAL');
            }, 4000);
        }

        function enterLowPower() {
            document.getElementById('currentState').textContent = 'LOW_POWER';
            document.getElementById('systemStatusIndicator').className = 'status-indicator status-low-power';
            deviceUI.addLog('warning', 'Transitioning to LOW_POWER mode');
            deviceUI.addLog('info', 'Shutting down non-essential services...');
            setTimeout(() => {
                deviceUI.addLog('info', 'WiFi interface disabled');
                deviceUI.addLog('info', 'Ethernet interfaces powered down');
                deviceUI.addLog('info', 'Modem entering low-power mode');
                deviceUI.addLog('info', 'Control transferred to LPM - wake signals active');
                deviceUI.addLog('success', 'LOW_POWER mode activated - consumption: 500ŒºA');
            }, 2000);
        }

        function updateConfig() {
            document.getElementById('configModal').style.display = 'block';
        }

        function restartServices() {
            deviceUI.addLog('warning', 'Restarting all system services...');
            deviceUI.addLog('info', 'Stopping docker containers...');
            setTimeout(() => {
                deviceUI.addLog('info', 'Reinitializing middleware services...');
                deviceUI.addLog('info', 'Restarting essential applications...');
            }, 1000);
            setTimeout(() => {
                deviceUI.addLog('info', 'Reloading device configurations...');
                deviceUI.addLog('success', 'All services restarted successfully');
                deviceUI.populateContainers();
            }, 3000);
        }

        function emergencyShutdown() {
            if (confirm('‚ö†Ô∏è EMERGENCY SHUTDOWN\n\nThis will immediately halt all operations and may cause data loss.\n\nAre you sure you want to proceed?')) {
                deviceUI.addLog('error', 'üõë EMERGENCY SHUTDOWN INITIATED');
                deviceUI.addLog('error', 'Forcing immediate shutdown of all services...');
                document.getElementById('currentState').textContent = 'SHUTDOWN';
                document.getElementById('systemStatusIndicator').className = 'status-indicator status-error';
                setTimeout(() => {
                    deviceUI.addLog('error', 'All processes terminated - system halted');
                }, 1000);
            }
        }

        function submitDiagnostics() {
            const level = document.getElementById('diagnosticLevel').value;
            const resultDiv = document.getElementById('diagnosticsResult');
            
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<p style="color: #E1FF16;">üîç Running diagnostics...</p>';
            deviceUI.addLog('info', `Initiating ${level} diagnostic sequence`);
            
            // Simulate diagnostic progress
            setTimeout(() => {
                resultDiv.innerHTML += '<p>‚úÖ Hardware interfaces tested</p>';
                deviceUI.addLog('info', 'Hardware interface tests completed');
            }, 1000);
            
            setTimeout(() => {
                resultDiv.innerHTML += '<p>‚úÖ Memory and storage verified</p>';
                deviceUI.addLog('info', 'Memory and storage verification completed');
            }, 2000);
            
            setTimeout(() => {
                if (level === 'advanced') {
                    resultDiv.innerHTML += '<p>‚úÖ Full system stress test executed</p>';
                    deviceUI.addLog('info', 'Advanced stress testing completed');
                }
            }, 3000);
            
            setTimeout(() => {
                const results = {
                    basic: { tests: 8, passed: 8, failed: 0, duration: '12.3s' },
                    medium: { tests: 15, passed: 14, failed: 1, duration: '28.7s' },
                    advanced: { tests: 32, passed: 30, failed: 2, duration: '74.2s' }
                };
                
                const result = results[level];
                resultDiv.innerHTML = `
                    <h4 style="color: #E1FF16; margin-bottom: 15px;">üìä Diagnostic Results:</h4>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <div><strong>Total Tests:</strong> ${result.tests}</div>
                        <div><strong>Duration:</strong> ${result.duration}</div>
                        <div style="color: #E1FF16;"><strong>Passed:</strong> ${result.passed}</div>
                        <div style="color: ${result.failed > 0 ? '#FF4F39' : '#E1FF16'};"><strong>Failed:</strong> ${result.failed}</div>
                    </div>
                    ${result.failed > 0 ? '<p style="color: #FF4F39; margin-top: 15px;">‚ö†Ô∏è Some tests failed - check system logs for details</p>' : '<p style="color: #E1FF16; margin-top: 15px;">‚úÖ All tests passed - system operating normally</p>'}
                `;
                
                const status = result.failed === 0 ? 'success' : 'warning';
                deviceUI.addLog(status, `${level.toUpperCase()} diagnostics completed - ${result.passed}/${result.tests} tests passed in ${result.duration}`);
            }, level === 'advanced' ? 4000 : 3500);
        }

        function submitConfig() {
            const name = document.getElementById('configName').value;
            const data = document.getElementById('configData').value;
            
            if (!name || !data) {
                alert('Please provide both configuration name and data');
                return;
            }

            try {
                JSON.parse(data); // Validate JSON
                deviceUI.addLog('info', `Applying configuration: ${name}`);
                deviceUI.addLog('info', 'Creating configuration backup...');
                setTimeout(() => {
                    deviceUI.addLog('info', 'Validating configuration format...');
                    deviceUI.addLog('success', `Configuration "${name}" applied successfully`);
                    closeModal();
                }, 2000);
            } catch (e) {
                alert('Invalid JSON format in configuration data');
                deviceUI.addLog('error', `Configuration validation failed: ${e.message}`);
            }
        }

        function closeModal() {
            document.getElementById('configModal').style.display = 'none';
            document.getElementById('diagnosticsModal').style.display = 'none';
            // Reset forms
            document.getElementById('configName').value = '';
            document.getElementById('configData').value = '';
            document.getElementById('diagnosticsResult').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const configModal = document.getElementById('configModal');
            const diagnosticsModal = document.getElementById('diagnosticsModal');
            if (event.target === configModal) {
                closeModal();
            }
            if (event.target === diagnosticsModal) {
                closeModal();
            }
        }

        // Initialize the device manager UI
        const deviceUI = new DeviceManagerUI();
